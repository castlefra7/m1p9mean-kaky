"use strict";(self.webpackChunkfront_e_kaly=self.webpackChunkfront_e_kaly||[]).push([[126],{126:(st,C,r)=>{r.r(C),r.d(C,{RestaurantModule:()=>it});var d=r(9808),f=r(4106),m=r(0),t=r(5e3);let y=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-current-orders"]],decls:2,vars:0,template:function(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"current-orders works!"),t.qZA())},styles:[""]}),e})();var c=r(3075);class D{constructor(o,n,i){this.name="",this.price=0,this.quantity=0,this._id="",this._id=o,this.name=n,this.price=i}}var l=r(9019),Z=r(520),v=r(2891);let g=(()=>{class e{constructor(n,i,s){this.http=n,this.router=i,this.auth=s}getAllDishes(){const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${l.N.url}/dishes?restau-id=${this.auth.restauId()}`,n)}getDish(n){const i={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${l.N.url}/dishes/${n}`,i)}updateDish(n){const i={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.put(`${l.N.url}/dishes/${n._id}`,JSON.stringify(n),i)}deleteDish(n){const i={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.delete(`${l.N.url}/dishes/${n}`,i)}insertDish(n){const i={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.post(`${l.N.url}/dishes/`,JSON.stringify({name:n.name,price:n.price}),i)}getAllProfits(){const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${l.N.url}/orders/amounts?restau-id=${this.auth.restauId()}`,n)}getAllCurrOrders(){const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${l.N.url}/orders?status=0&restau-id=${this.auth.restauId()}`,n)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(Z.eN),t.LFG(m.F0),t.LFG(v.e))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=r(7423),T=r(7531);function A(e,o){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Modification plat"),t.qZA())}function U(e,o){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Nouveau plat"),t.qZA())}const N=function(){return["/restaurant"]};let x=(()=>{class e{constructor(n,i,s,a){this.route=n,this.router=i,this.fb=s,this.restauService=a,this.dishForm=new c.cw({name:new c.NI(""),price:new c.NI("")}),this.id="",this.isUpdate=!1}ngOnInit(){this.route.params.subscribe(n=>{const i=n.id;i&&(this.isUpdate=!0,this.restauService.getDish(i).subscribe({next:s=>{this.id=s._id,this.dishForm.patchValue({name:s.name,price:s.price})},error:s=>console.error(s),complete:()=>console.info("complete")}))})}onSubmit(){const{name:n,price:i}=this.dishForm.value,s=new D(this.id,n,i);this.isUpdate?this.restauService.updateDish(s).subscribe({next:a=>{console.log(a),this.router.navigateByUrl("/restaurant")},error:a=>console.error(a),complete:()=>console.info("complete")}):this.restauService.insertDish(s).subscribe({next:a=>{console.log(a),this.router.navigateByUrl("/restaurant")},error:a=>console.error(a),complete:()=>console.info("complete")})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m.gz),t.Y36(m.F0),t.Y36(c.qu),t.Y36(g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dish-form"]],decls:21,vars:5,consts:[[1,"dish-form"],[3,"formGroup","ngSubmit"],[4,"ngIf"],["mat-raised-button","",3,"routerLink"],["appearance","standard"],["matInput","","placeholder","Placeholder","formControlName","name"],["matInput","","type","number","placeholder","Placeholder","formControlName","price"],["mat-raised-button","","color","primary"],["mat-raised-button",""]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.YNc(2,A,2,0,"h2",2),t.YNc(3,U,2,0,"h2",2),t.TgZ(4,"a",3),t._uU(5,"Retour"),t.qZA(),t.TgZ(6,"p")(7,"mat-form-field",4)(8,"mat-label"),t._uU(9,"Nom"),t.qZA(),t._UZ(10,"input",5),t.qZA()(),t.TgZ(11,"p")(12,"mat-form-field",4)(13,"mat-label"),t._uU(14,"Prix"),t.qZA(),t._UZ(15,"input",6),t.qZA()(),t.TgZ(16,"p")(17,"button",7),t._uU(18,"Valider"),t.qZA(),t.TgZ(19,"button",8),t._uU(20,"Annuler"),t.qZA()()()()),2&n&&(t.xp6(1),t.Q6J("formGroup",i.dishForm),t.xp6(1),t.Q6J("ngIf",i.isUpdate),t.xp6(1),t.Q6J("ngIf",!i.isUpdate),t.xp6(1),t.Q6J("routerLink",t.DdM(4,N)))},directives:[c._Y,c.JL,c.sg,d.O5,u.zs,m.yS,f.KE,f.hX,T.Nt,c.Fj,c.JJ,c.u,c.wV,u.lW],styles:[".dish-form[_ngcontent-%COMP%]{width:200px;margin:0 auto}"]}),e})();var _=r(4889),p=r(2781),h=r(9224);const L=function(e){return["form/",e]};let S=(()=>{class e{constructor(){this.dish=new D("","",0),this.delete=new t.vpe,this.modify=new t.vpe}ngOnInit(){}modifyEvent(){this.modify.emit(this.dish)}deleteEvent(){this.delete.emit(this.dish)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dish"]],inputs:{dish:"dish"},outputs:{delete:"delete",modify:"modify"},decls:10,vars:5,consts:[["mat-raised-button","","color","accent",3,"routerLink"],["mat-raised-button","","color","warn",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-title"),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-content"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-footer")(6,"a",0),t._uU(7,"Modifier"),t.qZA(),t.TgZ(8,"button",1),t.NdJ("click",function(){return i.deleteEvent()}),t._uU(9,"Supprimer"),t.qZA()()()),2&n&&(t.xp6(2),t.hij(" ",i.dish.name," "),t.xp6(2),t.hij(" Prix: ",i.dish.price," "),t.xp6(2),t.Q6J("routerLink",t.VKq(3,L,i.dish._id)))},directives:[h.a8,h.n5,h.dn,h.rt,u.zs,m.yS,u.lW],styles:[""]}),e})();function b(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"Liste plats"),t.qZA())}function w(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"Commande en cours"),t.qZA())}function Y(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Nom "),t.qZA())}function J(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function q(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Montant "),t.qZA())}function F(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.amount," ")}}function I(e,o){1&e&&t._UZ(0,"tr",18)}function $(e,o){1&e&&t._UZ(0,"tr",19)}function O(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"app-dish",22),t.NdJ("modify",function(s){return t.CHM(n),t.oxw(2).modifyDish(s)})("delete",function(s){return t.CHM(n),t.oxw(2).deleteDish(s)}),t.qZA()}2&e&&t.Q6J("dish",o.$implicit)}function Q(e,o){if(1&e&&(t.TgZ(0,"div",20),t.YNc(1,O,1,1,"app-dish",21),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.filteredDishes)}}function j(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Date "),t.qZA())}function k(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.date," ")}}function M(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Nom "),t.qZA())}function B(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function P(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Prix "),t.qZA())}function R(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.price," ")}}function z(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Montant "),t.qZA())}function X(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.amount," ")}}function E(e,o){1&e&&(t.TgZ(0,"th",16),t._uU(1," Status "),t.qZA())}function G(e,o){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.status," ")}}function H(e,o){1&e&&t._UZ(0,"tr",18)}function V(e,o){1&e&&t._UZ(0,"tr",19)}function W(e,o){if(1&e&&(t.TgZ(0,"div")(1,"h2"),t._uU(2,"Commandes en cours"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"table",6),t.ynx(6,23),t.YNc(7,j,2,0,"th",8),t.YNc(8,k,2,1,"td",9),t.BQk(),t.ynx(9,7),t.YNc(10,M,2,0,"th",8),t.YNc(11,B,2,1,"td",9),t.BQk(),t.ynx(12,24),t.YNc(13,P,2,0,"th",8),t.YNc(14,R,2,1,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,z,2,0,"th",8),t.YNc(17,X,2,1,"td",9),t.BQk(),t.ynx(18,25),t.YNc(19,E,2,0,"th",8),t.YNc(20,G,2,1,"td",9),t.BQk(),t.YNc(21,H,1,0,"tr",11),t.YNc(22,V,1,0,"tr",12),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.hij("Nombre: ",n.orders.length,""),t.xp6(1),t.Q6J("dataSource",n.orders),t.xp6(16),t.Q6J("matHeaderRowDef",n.ordersColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.ordersColumns)}}const K=function(){return["add"]},tt=[{path:"",component:(()=>{class e{constructor(n,i){this.restauService=n,this.auth=i,this.sidecolor="",this.maincolor="",this.filteredDishes=[],this.profits=[],this.profitsColumns=["name","amount"],this.orders=[],this.ordersColumns=["date","name","price","amount","status"],this.isDishes=!0}ngOnInit(){this.restauService.getAllDishes().subscribe({next:n=>{this.filteredDishes=n},error:n=>console.error(n),complete:()=>console.info("complete")}),this.restauService.getAllProfits().subscribe({next:n=>{this.profits=n},error:n=>console.error(n),complete:()=>console.info("complete")}),this.restauService.getAllCurrOrders().subscribe({next:n=>{const i=[];n.forEach(s=>{s.details.forEach(a=>{i.push({name:a.name,price:a.price,amount:a.amount,date:new Date(s.date),status:a.status})})}),this.orders=Object.assign([],i)},error:n=>console.error(n),complete:()=>console.info("complete")})}modifyDish(n){console.log(n)}deleteDish(n){this.restauService.deleteDish(n._id).subscribe({next:i=>{this.restauService.getAllDishes().subscribe({next:s=>{this.filteredDishes=s},error:s=>console.error(s),complete:()=>console.info("complete")})},error:i=>{},complete:()=>console.info("complete")})}toggleShow(){this.isDishes=!this.isDishes}showDishes(){this.isDishes=!0}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g),t.Y36(v.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-dishes"]],decls:29,vars:14,consts:[[1,"main-container"],["position","start","mode","side","opened","",1,"main-sidenav"],[1,"options"],["flex","50"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","amount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"main-content"],["mat-raised-button","","color","primary",3,"routerLink"],["class","dishes",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"dishes"],[3,"dish","modify","delete",4,"ngFor","ngForOf"],[3,"dish","modify","delete"],["matColumnDef","date"],["matColumnDef","price"],["matColumnDef","status"]],template:function(n,i){1&n&&(t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1)(2,"div",2)(3,"p",3)(4,"u"),t._uU(5,"Utilisateur:"),t.qZA(),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"button",4),t.NdJ("click",function(){return i.toggleShow()}),t.YNc(9,b,2,0,"span",5),t.YNc(10,w,2,0,"span",5),t.qZA()(),t.TgZ(11,"div")(12,"h2"),t._uU(13,"Profits par plat"),t.qZA(),t.TgZ(14,"table",6),t.ynx(15,7),t.YNc(16,Y,2,0,"th",8),t.YNc(17,J,2,1,"td",9),t.BQk(),t.ynx(18,10),t.YNc(19,q,2,0,"th",8),t.YNc(20,F,2,1,"td",9),t.BQk(),t.YNc(21,I,1,0,"tr",11),t.YNc(22,$,1,0,"tr",12),t.qZA()()(),t.TgZ(23,"mat-drawer-content",13)(24,"div")(25,"a",14),t._uU(26,"Ajouter plat"),t.qZA()(),t.YNc(27,Q,2,1,"div",15),t.YNc(28,W,23,4,"div",5),t.qZA()()),2&n&&(t.xp6(1),t.Udp("background",i.sidecolor),t.xp6(5),t.hij(" ",i.auth.name(),""),t.xp6(3),t.Q6J("ngIf",!i.isDishes),t.xp6(1),t.Q6J("ngIf",i.isDishes),t.xp6(4),t.Q6J("dataSource",i.profits),t.xp6(7),t.Q6J("matHeaderRowDef",i.profitsColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.profitsColumns),t.xp6(1),t.Udp("background",i.maincolor),t.xp6(2),t.Q6J("routerLink",t.DdM(13,K)),t.xp6(2),t.Q6J("ngIf",i.isDishes),t.xp6(1),t.Q6J("ngIf",!i.isDishes))},directives:[_.kh,_.jA,u.lW,d.O5,p.BZ,p.w1,p.fO,p.ge,p.Dz,p.ev,p.as,p.XQ,p.nj,p.Gk,_.LW,u.zs,m.yS,d.sg,S],styles:[".dishes[_ngcontent-%COMP%]{display:flex;gap:17px;flex-wrap:wrap}.options[_ngcontent-%COMP%]{display:flex;margin-bottom:17px}.main-sidenav[_ngcontent-%COMP%]{width:35%}.mat-drawer-container[_ngcontent-%COMP%]{height:100%}.main-content[_ngcontent-%COMP%]{padding:7px}table[_ngcontent-%COMP%]{width:100%}"]}),e})()},{path:"profits",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-profits"]],decls:1,vars:0,template:function(n,i){1&n&&t._UZ(0,"div")},styles:[""]}),e})()},{path:"form/:id",component:x},{path:"add",component:x},{path:"current",component:y}];let et=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:f.o2,useValue:{appearance:"fill"}}],imports:[[m.Bz.forChild(tt)],m.Bz]}),e})();var nt=r(3954),ot=r(5245);let it=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[c.qu,g],imports:[[d.ez,et,h.QW,nt.N6,u.ot,_.SJ,f.lN,T.c,ot.Ps,c.UX,Z.JF,p.p0]]}),e})()}}]);