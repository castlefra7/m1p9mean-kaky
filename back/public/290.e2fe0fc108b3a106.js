"use strict";(self.webpackChunkfront_e_kaly=self.webpackChunkfront_e_kaly||[]).push([[290],{290:(E,m,i)=>{i.r(m),i.d(m,{DeliverModule:()=>L});var v=i(9808),u=i(4106),l=i(0),t=i(5e3),d=i(9019),p=i(520);let f=(()=>{class e{constructor(n,a){this.http=n,this.router=a}updateStatus(n,a){const s={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.put(`${d.N.url}/orders/${n}/details/${a}/status`,{},s)}getAllOrders(){const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${d.N.url}/orders?status=0`,n)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(p.eN),t.LFG(l.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=i(2891),r=i(2781),h=i(7423);function Z(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Date "),t.qZA())}function T(e,o){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.date," ")}}function g(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Nom "),t.qZA())}function M(e,o){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function x(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Prix "),t.qZA())}function D(e,o){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.price," ")}}function A(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Montant "),t.qZA())}function N(e,o){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.amount," ")}}function y(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Status "),t.qZA())}function S(e,o){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.status," ")}}function U(e,o){1&e&&(t.TgZ(0,"th",11),t._uU(1," Action "),t.qZA())}function Y(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"td",12)(1,"button",13),t.NdJ("click",function(){const c=t.CHM(n).$implicit;return t.oxw().updateStatus(c.order_id,c.dish_id)}),t._uU(2,"Livrer"),t.qZA()()}}function _(e,o){1&e&&t._UZ(0,"tr",14)}function j(e,o){1&e&&t._UZ(0,"tr",15)}const B=[{path:"",component:(()=>{class e{constructor(n,a){this.deService=n,this.auth=a,this.orders=[],this.ordersColumns=["date","name","price","amount","status","action"]}ngOnInit(){this.fetch()}fetch(){this.deService.getAllOrders().subscribe({next:n=>{const a=[];n.forEach(s=>{s.details.forEach(c=>{a.push({name:c.name,price:c.price,amount:c.amount,date:new Date(s.date),status:c.status,dish_id:c.dish_id,order_id:s._id})})}),this.orders=Object.assign([],a)},error:n=>console.error(n),complete:()=>console.info("complete")})}updateStatus(n,a){this.deService.updateStatus(n,a).subscribe({next:s=>{this.fetch()},error:s=>console.error(s),complete:()=>console.info("complete")})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36(C.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main"]],decls:28,vars:5,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","amount"],["matColumnDef","status"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,a){1&n&&(t.TgZ(0,"div")(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"Liste des plats \xe0 livrer"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA(),t.TgZ(7,"table",0),t.ynx(8,1),t.YNc(9,Z,2,0,"th",2),t.YNc(10,T,2,1,"td",3),t.BQk(),t.ynx(11,4),t.YNc(12,g,2,0,"th",2),t.YNc(13,M,2,1,"td",3),t.BQk(),t.ynx(14,5),t.YNc(15,x,2,0,"th",2),t.YNc(16,D,2,1,"td",3),t.BQk(),t.ynx(17,6),t.YNc(18,A,2,0,"th",2),t.YNc(19,N,2,1,"td",3),t.BQk(),t.ynx(20,7),t.YNc(21,y,2,0,"th",2),t.YNc(22,S,2,1,"td",3),t.BQk(),t.ynx(23,8),t.YNc(24,U,2,0,"th",2),t.YNc(25,Y,3,0,"td",3),t.BQk(),t.YNc(26,_,1,0,"tr",9),t.YNc(27,j,1,0,"tr",10),t.qZA()()),2&n&&(t.xp6(2),t.hij("Livreur: ",a.auth.name(),""),t.xp6(4),t.hij("Nombre: ",a.orders.length,""),t.xp6(1),t.Q6J("dataSource",a.orders),t.xp6(19),t.Q6J("matHeaderRowDef",a.ordersColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.ordersColumns))},directives:[r.BZ,r.w1,r.fO,r.ge,r.Dz,r.ev,h.lW,r.as,r.XQ,r.nj,r.Gk],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),e})()}];let $=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:u.o2,useValue:{appearance:"fill"}}],imports:[[l.Bz.forChild(B)],l.Bz]}),e})();var Q=i(9224),F=i(3954),z=i(4889),J=i(7531),R=i(5245),O=i(3075);let L=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[f],imports:[[v.ez,$,Q.QW,F.N6,h.ot,z.SJ,u.lN,J.c,R.Ps,O.UX,p.JF,r.p0]]}),e})()}}]);