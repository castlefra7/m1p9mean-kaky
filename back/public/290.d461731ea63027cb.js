"use strict";(self.webpackChunkfront_e_kaly=self.webpackChunkfront_e_kaly||[]).push([[290],{290:(E,u,i)=>{i.r(u),i.d(u,{DeliverModule:()=>q});var c=i(9808),d=i(4106),l=i(0),t=i(5e3),p=i(9019),f=i(520);let h=(()=>{class e{constructor(n,a){this.http=n,this.router=a}updateStatus(n,a){const s={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.put(`${p.N.url}/orders/${n}/details/${a}/status`,{},s)}getAllOrders(){const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};return this.http.get(`${p.N.url}/orders?status=0`,n)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(f.eN),t.LFG(l.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=i(2891),v=i(773),r=i(2781),g=i(7423);function Z(e,o){1&e&&t._UZ(0,"mat-progress-spinner",13)}function T(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Date "),t.qZA())}function M(e,o){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n.date,"mediumDate")," ")}}function x(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Nom "),t.qZA())}function A(e,o){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function D(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Prix "),t.qZA())}function y(e,o){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.price)," ")}}function N(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Montant "),t.qZA())}function U(e,o){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.amount)," ")}}function _(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Quantit\xe9 "),t.qZA())}function Y(e,o){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.quantity)," ")}}function S(e,o){1&e&&(t.TgZ(0,"th",14),t._uU(1," Action "),t.qZA())}function j(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"td",15)(1,"button",16),t.NdJ("click",function(){const m=t.CHM(n).$implicit;return t.oxw().updateStatus(m.order_id,m.dish_id)}),t._uU(2,"Livrer"),t.qZA()()}}function B(e,o){1&e&&t._UZ(0,"tr",17)}function Q(e,o){1&e&&t._UZ(0,"tr",18)}const $=[{path:"",component:(()=>{class e{constructor(n,a){this.deService=n,this.auth=a,this.loading=!1,this.orders=[],this.ordersColumns=["date","name","price","amount","quantity","action"]}ngOnInit(){this.fetch()}fetch(){this.loading=!0,this.deService.getAllOrders().subscribe({next:n=>{const a=[];n.forEach(s=>{s.details.forEach(m=>{a.push({name:m.name,price:m.price,amount:m.amount,date:new Date(s.date),status:m.status,dish_id:m.dish_id,order_id:s._id,quantity:m.quantity})})}),this.orders=Object.assign([],a)},error:n=>console.error(n),complete:()=>this.loading=!1})}updateStatus(n,a){this.loading=!0,this.deService.updateStatus(n,a).subscribe({next:s=>{this.fetch()},error:s=>console.error(s),complete:()=>this.loading=!1})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(h),t.Y36(C.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main"]],decls:30,vars:8,consts:[[1,"main-content"],["diameter","50","mode","indeterminate",4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","amount"],["matColumnDef","quantity"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["diameter","50","mode","indeterminate"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div"),t._uU(2),t.ALo(3,"uppercase"),t.qZA(),t.TgZ(4,"h2"),t._uU(5,"Liste des plats \xe0 livrer"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.YNc(8,Z,1,0,"mat-progress-spinner",1),t.TgZ(9,"table",2),t.ynx(10,3),t.YNc(11,T,2,0,"th",4),t.YNc(12,M,3,4,"td",5),t.BQk(),t.ynx(13,6),t.YNc(14,x,2,0,"th",4),t.YNc(15,A,2,1,"td",5),t.BQk(),t.ynx(16,7),t.YNc(17,D,2,0,"th",4),t.YNc(18,y,3,3,"td",5),t.BQk(),t.ynx(19,8),t.YNc(20,N,2,0,"th",4),t.YNc(21,U,3,3,"td",5),t.BQk(),t.ynx(22,9),t.YNc(23,_,2,0,"th",4),t.YNc(24,Y,3,3,"td",5),t.BQk(),t.ynx(25,10),t.YNc(26,S,2,0,"th",4),t.YNc(27,j,3,0,"td",5),t.BQk(),t.YNc(28,B,1,0,"tr",11),t.YNc(29,Q,1,0,"tr",12),t.qZA()()),2&n&&(t.xp6(2),t.hij("Livreur: ",t.lcZ(3,6,a.auth.name()),""),t.xp6(5),t.hij("Nombre: ",a.orders.length,""),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(1),t.Q6J("dataSource",a.orders),t.xp6(19),t.Q6J("matHeaderRowDef",a.ordersColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.ordersColumns))},directives:[c.O5,v.Ou,r.BZ,r.w1,r.fO,r.ge,r.Dz,r.ev,g.lW,r.as,r.XQ,r.nj,r.Gk],pipes:[c.gd,c.uU,c.JJ],styles:["table[_ngcontent-%COMP%]{width:100%}.main-content[_ngcontent-%COMP%]{width:90%;margin:0 auto}"]}),e})()}];let J=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:d.o2,useValue:{appearance:"fill"}}],imports:[[l.Bz.forChild($)],l.Bz]}),e})();var L=i(9224),O=i(3954),F=i(4889),z=i(7531),R=i(5245),I=i(3075);let q=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[h],imports:[[c.ez,J,L.QW,O.N6,g.ot,F.SJ,d.lN,z.c,R.Ps,I.UX,f.JF,r.p0,v.Cq]]}),e})()}}]);